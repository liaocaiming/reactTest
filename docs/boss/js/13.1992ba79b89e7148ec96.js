(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1164:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return V})),n(552);var r=n(550),a=n(524),o=n.n(a),i=n(81),c=n.n(i),l=(n(307),n(96)),s=n(55),u=n.n(s),d=n(56),f=n.n(d),p=n(57),h=n.n(p),m=n(58),v=n.n(m),y=n(31),b=n.n(y),O=n(0),g=n(516),w=n(522),S=(n(745),n(741)),j=[];var x,E=function(e){var t=e&&e.toUpperCase();return t.indexOf("M")>0?parseInt(e):t.indexOf("H")>0?60*parseInt(e):t.indexOf("D")>0?"D":t.indexOf("W")>0?"W":void 0},_=function(e){h()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var a=b()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return v()(this,n)}}(n);function n(){return u()(this,n),t.apply(this,arguments)}return f()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.interval,n=e.symbol;console.log(E(t),"438999"),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,r){var a,o=t.timeout,i=void 0===o?6e3:o,c=t.attrs,l=document.getElementsByTagName("script"),s=l.length,u=document.createElement("script"),d=null;for(a=0;a<s;a++)if(e.split("?")[0]===l[a].src.split("?")[0])return n(),null;return-1!==j.indexOf(e)?(n(),null):(u.type="text/javascript",c&&Object.keys(c).forEach((function(e){u.setAttribute(e,c[e])})),u.readyState?u.onreadystatechange=function(){"loaded"!==u.readyState&&"complete"!==u.readyStat||(u.onreadystatechange=null,n(),j.push(e),clearTimeout(d))}:u.onload=function(){n(),j.push(e),clearTimeout(d)},d=setTimeout((function(){var t=j.indexOf(e);n("load script ".concat(e," error!")),document.body.removeChild(u),-1!==t&&j.splice(t,1)}),i),"function"==typeof u.onerror&&(u.onerror=function(e){n(e)}),u.src=e,document.body.appendChild(u),u)}))}("https://s3.tradingview.com/tv.js").then((function(){new TradingView.widget({width:1200,height:710,symbol:"BINANCE:".concat(n.toUpperCase()),interval:E(t),timezone:"Etc/UTC",theme:"light",style:"1",locale:"zh_CN",toolbar_bg:"#f1f3f6",enable_publishing:!1,allow_symbol_change:!0,container_id:"tradingView",hide_side_toolbar:!1,studies:["MACD@tv-basicstudies","StochasticRSI@tv-basicstudies"]})}))}},{key:"render",value:function(){return O.createElement(S.a,{title:"TradingView图标",width:1500,visible:!0,footer:null,onCancel:this.props.onClose},O.createElement("div",{id:"tradingView",className:"tradingView"}))}}]),n}(O.PureComponent),C=[{value:"future",label:"合约"},{value:"xianhuo",label:"现货"}],T={1:"上穿",2:"下穿"},I=["ema_7","ema_30","ema_100","ema_144","ema_169","ema_200","ema_300"],R=[{title:"币名称",dataIndex:"symbol"},{title:"收盘价",dataIndex:"close"}],N=[{title:"校验对",dataIndex:"coinType",eleAttr:{allowClear:!1}},{title:"交易类型",dataIndex:"type"},{title:"周期",dataIndex:"interval"},{title:"指标",dataIndex:"indicators",eleAttr:{mode:"tags",placeholder:"请输入指标, 如 ema_7, am_30",style:{width:300}}},{title:"上穿或下穿",dataIndex:"filterType"}],k=["USDT","BTC"],D=n(207),P=n(221),M=n(112),B=n(170);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=Object(g.b)()(x=function(e){h()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var a=b()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return v()(this,n)}}(n);function n(e){var r;return u()(this,n),(r=t.call(this,e)).indicators=[],r.chartOptions={symbol:"BTCUSDT",interval:"1h"},r.options=[{title:"涨幅(close-open)/close",dataIndex:"diffRate",defaultSortOrder:"descend",sorter:function(e,t){return e.diffRate-t.diffRate},render:function(e){var t=parseFloat(e&&e.toFixed(3));return O.createElement("span",{className:Object(M.reactClassNameJoin)([t>0?"green":"red","diff"])},t>0?"+".concat(t," %"):"".concat(t," %"))}},{title:"操作",dataIndex:"operate",render:function(e,t){return O.createElement("a",{onClick:r.toggleModal("isShow",!0,t)},"打开看图表")}}],r.handleSearch=function(e){var t=R.slice();if(e.interval)if(e.indicators){if(JSON.stringify(e.indicators)!==JSON.stringify(r.indicators)){r.indicators=e.indicators;var n=[];r.indicators.forEach((function(e){n.push({title:e,dataIndex:e,render:function(t,n){var r=n["".concat(e,"_price")];return O.createElement("div",null,O.createElement("span",null,t),O.createElement(w.d,{isShow:r},O.createElement("span",{className:Object(M.reactClassNameJoin)([r>0?"green":"red","diff"])},"(",r>0?"+".concat(r," "):"".concat(r," "),")")))}},{title:"".concat(e," / close"),dataIndex:"".concat(e,"_rate"),defaultSortOrder:"descend",sorter:function(t,n){return t["".concat(e,"_rate")]-n["".concat(e,"_rate")]},render:function(e,t){var n=parseFloat(e&&e.toFixed(3));return O.createElement("div",null,O.createElement(w.d,{isShow:!!n},O.createElement("span",{className:Object(M.reactClassNameJoin)([n>0?"green":"red","diff"])},n>0?"+".concat(n," %"):"".concat(n," %"))))}})})),t=t.concat(n).concat(r.options),r.setState((function(){return{rows:t}}))}Object.assign(r.chartOptions,{interval:e.interval}),r.getList(e)}else l.b.warn("请选择指标");else l.b.warn("请选择周期")},r.toggleModal=function(e,t,n){return function(){n&&Object.assign(r.chartOptions,{symbol:n.symbol}),r.setState(c()({},e,t))}},r.state={rows:R,list:[],isShow:!1},r}return f()(n,[{key:"componentDidMount",value:function(){}},{key:"getList",value:function(e){var t=this;this.props.actions.get("".concat(B.a.get_indicators),e).then((function(n){var r=e.indicators,a=e.filterType,i=r.toString().match(/(\d+)/g),l=Math.max.apply(null,i),s=r.find((function(e){return e.indexOf(l)>=0})),u=[];n.forEach((function(e){var t=(e||{}).price,n=(void 0===t?[]:t)||[],i=o()(n,1)[0],l=void 0===i?{}:i,d=l.close,f=l.open,p=e[s],h={},m=!0;r.forEach((function(t){var n;null!==e[t]&&void 0!==e[t]||(m=!1),s!==t&&("1"===String(a)?Object(P.c)(e[t],p)<0&&(m=!1):"2"===String(a)&&Object(P.c)(e[t],p)>0&&(m=!1)),Object.assign(h,(n={},c()(n,"".concat(t,"_price"),Object(P.c)(d,e[t])),c()(n,"".concat(t,"_rate"),Object(P.b)(Object(P.a)(Object(P.c)(d,e[t]),d),100)),c()(n,"close",d),c()(n,"diffRate",Object(P.b)(Object(P.a)(Object(P.c)(d,f),d),100)),n))})),m&&u.push(U(U({},e),h))})),t.setState({list:u})}))}},{key:"renderSearch",value:function(){return O.createElement(w.b,{rowData:N,handleSearch:this.handleSearch,selectKeys:["indicators"],defaultValues:{coinType:"USDT"},map:{coinType:"coin_type"},selectMap:{filterType:T,interval:D.intervals,type:C,indicators:I,coinType:k}})}},{key:"renderTable",value:function(){var e=this.state,t=e.rows,n=e.list;return O.createElement(w.c,{dataSource:n,columns:t,pagination:!1,scroll:{y:"70vh"}})}},{key:"renderChartModal",value:function(){var e=this.state.isShow,t=this.chartOptions,n=t.interval,r=t.symbol;return e?O.createElement(_,{isShow:e,interval:n,symbol:r,onClose:this.toggleModal("isShow",!1)}):null}},{key:"render",value:function(){return O.createElement(r.a,{className:"bestCoinList"},this.renderSearch(),this.renderTable(),this.renderChartModal())}}]),n}(O.PureComponent))||x}}]);